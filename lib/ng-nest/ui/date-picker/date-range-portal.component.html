<div class="x-date-range-portal {{ type }}">
  <div class="x-date-range-portal-body" [ngSwitch]="type">
    <ng-container *ngSwitchCase="'date'">
      <x-picker-date
        #startPicker
        class="x-date-range-portal-start"
        [(display)]="startDisplay"
        [model]="startModel"
        [rangeValue]="value"
        [rangeType]="activeType"
        [nextYearBtn]="false"
        [nextMonthBtn]="false"
        (modelChange)="dateChange($event)"
        (yearChange)="yearChange($event, 'start')"
        (monthChange)="monthChange($event, 'start')"
        (rangeTdMouseenter)="setDatesState($event)"
        (rangeDateClick)="setDatesState($event)"
        rangePicker
      ></x-picker-date>
      <x-picker-date
        #endPicker
        class="x-date-range-portal-end"
        [(display)]="endDisplay"
        [model]="endModel"
        [rangeValue]="value"
        [rangeType]="activeType"
        [lastYearBtn]="false"
        [lastMonthBtn]="false"
        (modelChange)="dateChange($event)"
        (yearChange)="yearChange($event, 'end')"
        (monthChange)="monthChange($event, 'end')"
        (rangeTdMouseenter)="setDatesState($event)"
        (rangeDateClick)="setDatesState($event)"
        rangePicker
      ></x-picker-date>
    </ng-container>
    <ng-container *ngSwitchCase="'month'">
      <x-picker-month
        #startPicker
        class="x-date-range-portal-start"
        [(display)]="startDisplay"
        [model]="startModel"
        [rangeValue]="value"
        [rangeType]="activeType"
        [nextYearBtn]="false"
        (modelChange)="dateChange($event)"
        (yearChange)="yearChange($event, 'start')"
        (monthChange)="monthChange($event, 'start')"
        (rangeTdMouseenter)="setDatesState($event)"
        (rangeDateClick)="setDatesState($event)"
        rangePicker
      ></x-picker-month>
      <x-picker-month
        #endPicker
        class="x-date-range-portal-end"
        [(display)]="endDisplay"
        [model]="endModel"
        [rangeValue]="value"
        [rangeType]="activeType"
        [lastYearBtn]="false"
        (modelChange)="dateChange($event)"
        (yearChange)="yearChange($event, 'end')"
        (monthChange)="monthChange($event, 'end')"
        (rangeTdMouseenter)="setDatesState($event)"
        (rangeDateClick)="setDatesState($event)"
        rangePicker
      ></x-picker-month>
    </ng-container>
    <ng-container *ngSwitchCase="'year'">
      <x-picker-year
        #startPicker
        class="x-date-range-portal-start"
        [(display)]="startDisplay"
        [model]="startModel"
        [rangeValue]="value"
        [rangeType]="activeType"
        [nextYearBtn]="false"
        (modelChange)="dateChange($event)"
        (yearChange)="yearChange($event, 'start')"
        (monthChange)="monthChange($event, 'start')"
        (rangeTdMouseenter)="setDatesState($event)"
        (rangeDateClick)="setDatesState($event)"
        rangePicker
      ></x-picker-year>
      <x-picker-year
        #endPicker
        class="x-date-range-portal-end"
        [(display)]="endDisplay"
        [model]="endModel"
        [rangeValue]="value"
        [rangeType]="activeType"
        [lastYearBtn]="false"
        (modelChange)="dateChange($event)"
        (yearChange)="yearChange($event, 'end')"
        (monthChange)="monthChange($event, 'end')"
        (rangeTdMouseenter)="setDatesState($event)"
        (rangeDateClick)="setDatesState($event)"
        rangePicker
      ></x-picker-year>
    </ng-container>
    <ng-container *ngSwitchCase="'date-time'">
      <ng-container *ngTemplateOutlet="dateTimeHourMinuteTpl; context: { timeFormat: 'HH:mm:ss', timeType: 'time' }"></ng-container>
    </ng-container>
    <ng-container *ngSwitchCase="'date-hour'">
      <ng-container *ngTemplateOutlet="dateTimeHourMinuteTpl; context: { timeFormat: 'HH', timeType: 'hour' }"></ng-container>
    </ng-container>
    <ng-container *ngSwitchCase="'date-minute'">
      <ng-container *ngTemplateOutlet="dateTimeHourMinuteTpl; context: { timeFormat: 'HH:mm', timeType: 'minute' }"></ng-container>
    </ng-container>
  </div>
</div>

<ng-template #dateTimeHourMinuteTpl let-timeFormat="timeFormat" let-timeType="timeType">
  <div class="x-date-range-portal-content">
    <div class="x-date-range-portal-date">
      <x-picker-date
        [class.x-date-range-portal-start]="activeType === 'start'"
        [class.x-date-range-portal-end]="activeType === 'end'"
        [(display)]="timeDisplay"
        [(model)]="timeModel"
        [rangeHover]="timeHover"
        [rangeValue]="value"
        [rangeType]="activeType"
        (modelChange)="dateChange($event)"
        rangePicker
      ></x-picker-date>
    </div>
    <div class="x-date-range-portal-time">
      <div class="x-date-range-portal-time-label">
        {{ time | date : timeFormat }}
      </div>
      <x-time-picker-frame [type]="timeType" [value]="time" (nodeEmit)="selectTime($event)" [defaultNow]="false"></x-time-picker-frame>
    </div>
  </div>
  <div class="x-date-range-portal-footer">
    <x-button type="primary" (click)="sureTime()" size="small" [disabled]="timeSureDisabled">{{ locale.sure }}</x-button>
  </div>
</ng-template>
