<ng-content></ng-content>

@if (!fullScreen()) {
  <ng-container *ngTemplateOutlet="loadingTpl"></ng-container>
}

<ng-template #loadingTpl>
  @if (loading()) {
    <div
      #loading
      class="x-loading"
      [ngClass]="classMap()"
      [style.background]="background()"
      [style.zIndex]="zIndex()"
      [class.x-loading-radius]="isRadius()"
      [class.x-loading-top-left-radius]="includeRadius('top-start')"
      [class.x-loading-top-right-radius]="includeRadius('top-end')"
      [class.x-loading-bottom-left-radius]="includeRadius('bottom-start')"
      [class.x-loading-bottom-left-radius]="includeRadius('bottom-end')"
      [class.x-loading-inline]="inline()"
    >
      <div class="x-loading-inner" [style.color]="color()">
        @if (icon()) {
          <div class="x-loading-icon" [style.font-size.px]="sizeNumber()">
            <x-icon [type]="icon()!"></x-icon>
          </div>
        } @else {
          @switch (type()) {
            @case ('circular') {
              <ng-container *ngTemplateOutlet="circularTpl"></ng-container>
            }
            @case ('spinner') {
              <ng-container *ngTemplateOutlet="spinnerTpl"></ng-container>
            }
            @case ('ripple') {
              <ng-container *ngTemplateOutlet="rippleTpl"></ng-container>
            }
            @case ('dual-ring') {
              <ng-container *ngTemplateOutlet="dualRingTpl"></ng-container>
            }
            @case ('dual-ball') {
              <ng-container *ngTemplateOutlet="dualBallTpl"></ng-container>
            }
            @case ('bars') {
              <ng-container *ngTemplateOutlet="barsTpl"></ng-container>
            }
            @default {
              <ng-container *ngTemplateOutlet="circularTpl"></ng-container>
            }
          }
        }
        <div class="x-loading-text">
          <ng-container *xOutlet="text()">{{ text() }}</ng-container>
        </div>
      </div>
    </div>
  }
</ng-template>

<ng-template #circularTpl>
  <svg
    class="x-loading-circular"
    [style.width.px]="sizeNumber()"
    [style.height.px]="sizeNumber()"
    viewBox="25 25 50 50"
  >
    <circle class="x-loading-path" cx="50" cy="50" r="20" fill="none" />
  </svg>
</ng-template>

<ng-template #spinnerTpl>
  <svg class="x-loading-spinner" [style.width.px]="sizeNumber()" [style.height.px]="sizeNumber()" viewBox="25 25 50 50">
    <g>
      <g transform="rotate(0 50 50)">
        <rect fill="currentColor" height="11" width="6" ry="0.66" rx="0.66" y="25.5" x="47">
          <animate
            repeatCount="indefinite"
            begin="-0.9166666666666666s"
            dur="1s"
            keyTimes="0;1"
            values="1;0"
            attributeName="opacity"
          ></animate>
        </rect>
      </g>
      <g transform="rotate(30 50 50)">
        <rect fill="currentColor" height="11" width="6" ry="0.66" rx="0.66" y="25.5" x="47">
          <animate
            repeatCount="indefinite"
            begin="-0.8333333333333334s"
            dur="1s"
            keyTimes="0;1"
            values="1;0"
            attributeName="opacity"
          ></animate>
        </rect>
      </g>
      <g transform="rotate(60 50 50)">
        <rect fill="currentColor" height="11" width="6" ry="0.66" rx="0.66" y="25.5" x="47">
          <animate
            repeatCount="indefinite"
            begin="-0.75s"
            dur="1s"
            keyTimes="0;1"
            values="1;0"
            attributeName="opacity"
          ></animate>
        </rect>
      </g>
      <g transform="rotate(90 50 50)">
        <rect fill="currentColor" height="11" width="6" ry="0.66" rx="0.66" y="25.5" x="47">
          <animate
            repeatCount="indefinite"
            begin="-0.6666666666666666s"
            dur="1s"
            keyTimes="0;1"
            values="1;0"
            attributeName="opacity"
          ></animate>
        </rect>
      </g>
      <g transform="rotate(120 50 50)">
        <rect fill="currentColor" height="11" width="6" ry="0.66" rx="0.66" y="25.5" x="47">
          <animate
            repeatCount="indefinite"
            begin="-0.5833333333333334s"
            dur="1s"
            keyTimes="0;1"
            values="1;0"
            attributeName="opacity"
          ></animate>
        </rect>
      </g>
      <g transform="rotate(150 50 50)">
        <rect fill="currentColor" height="11" width="6" ry="0.66" rx="0.66" y="25.5" x="47">
          <animate
            repeatCount="indefinite"
            begin="-0.5s"
            dur="1s"
            keyTimes="0;1"
            values="1;0"
            attributeName="opacity"
          ></animate>
        </rect>
      </g>
      <g transform="rotate(180 50 50)">
        <rect fill="currentColor" height="11" width="6" ry="0.66" rx="0.66" y="25.5" x="47">
          <animate
            repeatCount="indefinite"
            begin="-0.4166666666666667s"
            dur="1s"
            keyTimes="0;1"
            values="1;0"
            attributeName="opacity"
          ></animate>
        </rect>
      </g>
      <g transform="rotate(210 50 50)">
        <rect fill="currentColor" height="11" width="6" ry="0.66" rx="0.66" y="25.5" x="47">
          <animate
            repeatCount="indefinite"
            begin="-0.3333333333333333s"
            dur="1s"
            keyTimes="0;1"
            values="1;0"
            attributeName="opacity"
          ></animate>
        </rect>
      </g>
      <g transform="rotate(240 50 50)">
        <rect fill="currentColor" height="11" width="6" ry="0.66" rx="0.66" y="25.5" x="47">
          <animate
            repeatCount="indefinite"
            begin="-0.25s"
            dur="1s"
            keyTimes="0;1"
            values="1;0"
            attributeName="opacity"
          ></animate>
        </rect>
      </g>
      <g transform="rotate(270 50 50)">
        <rect fill="currentColor" height="11" width="6" ry="0.66" rx="0.66" y="25.5" x="47">
          <animate
            repeatCount="indefinite"
            begin="-0.16666666666666666s"
            dur="1s"
            keyTimes="0;1"
            values="1;0"
            attributeName="opacity"
          ></animate>
        </rect>
      </g>
      <g transform="rotate(300 50 50)">
        <rect fill="currentColor" height="11" width="6" ry="0.66" rx="0.66" y="25.5" x="47">
          <animate
            repeatCount="indefinite"
            begin="-0.08333333333333333s"
            dur="1s"
            keyTimes="0;1"
            values="1;0"
            attributeName="opacity"
          ></animate>
        </rect>
      </g>
      <g transform="rotate(330 50 50)">
        <rect fill="currentColor" height="11" width="6" ry="0.66" rx="0.66" y="25.5" x="47">
          <animate
            repeatCount="indefinite"
            begin="0s"
            dur="1s"
            keyTimes="0;1"
            values="1;0"
            attributeName="opacity"
          ></animate>
        </rect>
      </g>
      <g></g>
    </g>
  </svg>
</ng-template>
<ng-template #rippleTpl>
  <svg class="x-loading-ripple" [style.width.px]="sizeNumber()" [style.height.px]="sizeNumber()" viewBox="0 0 100 100">
    <g>
      <circle stroke-width="6" stroke="currentColor" fill="none" r="0" cy="50" cx="50">
        <animate
          begin="0s"
          calcMode="spline"
          keySplines="0 0.2 0.8 1"
          keyTimes="0;1"
          values="0;40"
          dur="1s"
          repeatCount="indefinite"
          attributeName="r"
        ></animate>
        <animate
          begin="0s"
          calcMode="spline"
          keySplines="0.2 0 0.8 1"
          keyTimes="0;1"
          values="1;0"
          dur="1s"
          repeatCount="indefinite"
          attributeName="opacity"
        ></animate>
      </circle>
      <circle stroke-width="6" stroke="currentColor" fill="none" r="0" cy="50" cx="50">
        <animate
          begin="-0.5s"
          calcMode="spline"
          keySplines="0 0.2 0.8 1"
          keyTimes="0;1"
          values="0;40"
          dur="1s"
          repeatCount="indefinite"
          attributeName="r"
        ></animate>
        <animate
          begin="-0.5s"
          calcMode="spline"
          keySplines="0.2 0 0.8 1"
          keyTimes="0;1"
          values="1;0"
          dur="1s"
          repeatCount="indefinite"
          attributeName="opacity"
        ></animate>
      </circle>
    </g>
  </svg>
</ng-template>
<ng-template #dualRingTpl>
  <svg
    class="x-loading-dual-ring"
    [style.width.px]="sizeNumber()"
    [style.height.px]="sizeNumber()"
    viewBox="0 0 100 100"
  >
    <g>
      <circle
        stroke-linecap="round"
        fill="none"
        stroke-dasharray="50.26548245743669 50.26548245743669"
        stroke="currentColor"
        stroke-width="8"
        r="32"
        cy="50"
        cx="50"
      >
        <animateTransform
          values="0 50 50;360 50 50"
          keyTimes="0;1"
          dur="1s"
          repeatCount="indefinite"
          type="rotate"
          attributeName="transform"
        ></animateTransform>
      </circle>
    </g>
  </svg>
</ng-template>
<ng-template #dualBallTpl>
  <svg
    class="x-loading-dual-ball"
    [style.width.px]="sizeNumber()"
    [style.height.px]="sizeNumber()"
    viewBox="0 0 100 100"
  >
    <g>
      <circle r="20" fill="currentColor" cy="50" cx="30">
        <animate
          begin="-0.5s"
          values="30;70;30"
          keyTimes="0;0.5;1"
          dur="1s"
          repeatCount="indefinite"
          attributeName="cx"
        ></animate>
      </circle>
      <circle r="20" fill="var(--x-primary-500)" cy="50" cx="70">
        <animate
          begin="0s"
          values="30;70;30"
          keyTimes="0;0.5;1"
          dur="1s"
          repeatCount="indefinite"
          attributeName="cx"
        ></animate>
      </circle>
      <circle r="20" fill="currentColor" cy="50" cx="30">
        <animate
          begin="-0.5s"
          values="30;70;30"
          keyTimes="0;0.5;1"
          dur="1s"
          repeatCount="indefinite"
          attributeName="cx"
        ></animate>
        <animate
          repeatCount="indefinite"
          dur="1s"
          keyTimes="0;0.499;0.5;1"
          calcMode="discrete"
          values="0;0;1;1"
          attributeName="fill-opacity"
        ></animate>
      </circle>
    </g>
  </svg>
</ng-template>
<ng-template #barsTpl>
  <svg class="x-loading-bars" [style.width.px]="sizeNumber()" [style.height.px]="sizeNumber()" viewBox="0 0 100 100">
    <g>
      <rect fill="currentColor" height="40" width="10" y="30" x="15">
        <animate
          begin="-0.6"
          values="1;0.2;1"
          keySplines="0.5 0 0.5 1;0.5 0 0.5 1"
          keyTimes="0;0.5;1"
          calcMode="spline"
          repeatCount="indefinite"
          dur="1s"
          attributeName="opacity"
        ></animate>
      </rect>
      <rect fill="var(--x-primary-200)" height="40" width="10" y="30" x="35">
        <animate
          begin="-0.4"
          values="1;0.2;1"
          keySplines="0.5 0 0.5 1;0.5 0 0.5 1"
          keyTimes="0;0.5;1"
          calcMode="spline"
          repeatCount="indefinite"
          dur="1s"
          attributeName="opacity"
        ></animate>
      </rect>
      <rect fill="var(--x-primary-400)" height="40" width="10" y="30" x="55">
        <animate
          begin="-0.2"
          values="1;0.2;1"
          keySplines="0.5 0 0.5 1;0.5 0 0.5 1"
          keyTimes="0;0.5;1"
          calcMode="spline"
          repeatCount="indefinite"
          dur="1s"
          attributeName="opacity"
        ></animate>
      </rect>
      <rect fill="var(--x-primary-600)" height="40" width="10" y="30" x="75">
        <animate
          begin="-1"
          values="1;0.2;1"
          keySplines="0.5 0 0.5 1;0.5 0 0.5 1"
          keyTimes="0;0.5;1"
          calcMode="spline"
          repeatCount="indefinite"
          dur="1s"
          attributeName="opacity"
        ></animate>
      </rect>
    </g>
  </svg>
</ng-template>
